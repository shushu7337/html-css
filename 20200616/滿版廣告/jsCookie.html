<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <title>jsCookie</title>
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        .main{
            width: 100vw;
            height: 100vh;
        }
        .myFull{
            position: fixed;
            background: rgba(122, 77, 48, 0.418);
            z-index: 999;
            width: 100vw;
            height: 100vh;

            display: flex;
            justify-content: center;
            align-items: center;
        }
        .myContent{
            cursor:pointer;
            position: relative;
        }
        .myContent .myClose{
            position:absolute;
            right: -1rem;
            top: -1rem;
            color: rgb(69, 213, 223);
            font-size: 2rem;
            border: solid 1px rgb(4, 55, 107);
            border-radius: 50%;
            background: rgb(69, 122, 139);
        }
        .myClose:hover{
            background:lightpink
        }
    </style>
</head>
<body>
    <!-- 每日廣告 -->
    <div class="myFull" >
        <div class="myContent">
            <div>
                <img style="height: 600px;width: 900px;"  src="https://imgs.aixifan.com/o_1dcehbadvrka14km1oigsdu1or58.jpg">
                
                    <span class="myClose material-icons" >
                        cancel
                    </span>
                
            </div>
        </div>
    </div>
    <!-- 主題 -->
    <div class="main">
        <iframe width="100%" height="100%" src="https://www.youtube.com/embed/0xSiBpUdW4E?autoplay=1&mute=1" frameborder="0"></iframe>
    </div>


    <script>
        // 關閉廣告
        function adclose(){
            // type 1   整個style會被display:none覆蓋
            // document.getElementsByClassName("myFull")[0].style="display:none";

            // type 2 針對style內的 display 設定為 none
            document.getElementsByClassName("myFull")[0].style.display="none";
        }

        // 廣告轉址
        function adgoto(){
            // 給予網址，並做另開視窗
            open("https://www.moshimoshi-nippon.jp/zh-hant/175919","_self");
        }

//  type 1 直接在上面html標籤內加入onclick="所需函式"
        /*
        <div class="myFull" onclick="adclose()">
        <div class="main" onclick="adgoto()">
        */

//  type 2 使用listener
        let ImgClose=document.getElementsByClassName("myFull")[0];
        let ImgLink=document.getElementsByClassName("myContent")[0];
        
        ImgClose.addEventListener("click",adclose);
        ImgLink.addEventListener("click",adgoto);

//  type 3 一行式
    // document.getElementsByClassName("myFull")[0].onclick=adclose;
    // document.getElementsByClassName("myContent")[0].getElementsByTagName("img")[0]onclick=adgoto.


// *** 設定cookie ***
/*
    let nowtime=new Date();
    lifetime=10;
    nowtime.setTime(nowtime.getTime()+lifetime*500);   //add 10 sec save to time's obj 將nowtime設定現在時間在增加10秒鐘後，存回nowtime
//  給予cookie有效期限(cookie無法直接刪除只能給予有效期限)
    document.cookie="shu=123;expires="+nowtime.toUTCString();
    // 步驟分解
    // nowtime.toUTCString="Wed, 17 Jun 2020 02:33:54 GMT"
    // document.cookie="shu=123;expires="+ "Wed, 17 Jun 2020 02:33:54 GMT"
*/

function findcookie(name){

    // 用ck來接撈出的cookie字串
    // let ck=document.cookie;
    // split 切割指定位置然後以陣列的方式來做回存
    // let ckarray=ck.split("; ");

    // 精簡版
    let ckary=document.cookie.split("; ");    //依條件分割成為一組陣列
    // 透過find()來收尋要的字串
    let ckget= ckary.find(function(e){
        //1st e="max=7788";
        // "max="  != "ma="
        return (name+"=" === e.substr(0,name.length+1));
    });

    //極度精簡版
    // let ckget = ckary.find(e=>name + "=" === e.substr(0,name,length +1)) ;

    //究及精簡版
    // let ckget = document.cookie.split("; ").find(e=>name + "=" === e.substr(0,name,length +1)) ;

    // return ckget;
    return (ckget)?true:false;  //如果ckget有東西的話回傳true 沒有的話回傳false
}


let ckeat=findcookie("adWatch");
if(!ckeat){ //新訪客的處理事項
    let end=new Date();
    end.setHours(23),end.setMinutes(59),end.setSeconds(59);
    console.log(end);
    document.cookie="adWatch=yes;expires="+end.toUTCString();
}else{  //已看過廣告的訪客
    console.log("已看過廣告");
    // document.getElementsByClassName("myFull")[0].style="display:none";
    adclose()
    // document.getElementsByClassName("myFull")[0].remove();   //移除該元素
}
    </script>
</body>
</html>